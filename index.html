<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Node Flow Demo</title>
    <link rel="shortcut icon" href="#" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body {
            width: 100%;
            height: 100%;
        }

        canvas {
            width: 100%;
            height: 100%;
            display: block;
        }
    </style>

    <script src="./dist/web/index.js"></script>
</head>

<body>
    <canvas id="canvas"></canvas>
    <script>
        const canvas = document.getElementById("canvas");
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas, false);
        resizeCanvas();

        NodeFlowTheme.FontFamily = "Source Code Pro";

        const node1 = new FlowNode({ title: "Test Node 1", position: { x: 0, y: 100 } });
        node1.addOutput({ name: "test out 1", type: "string" })
        node1.addOutput({ name: "test out 2", type: "int" })
        node1.addOutput({ name: "A super duper long name!!!", type: "bool" })
        node1.addWidget(new ColorWidget({ value: "#000000" }));
        node1.addWidget(new NumberWidget({ value: 1.2345 }));
        node1.addWidget(new StringWidget({ value: "woo!" }));
        node1.addWidget(new StringWidget({ value: "A super duper long text input" }));
        node1.addWidget(new ButtonWidget({
            text: "Click Me!",
            callback: () => {
                alert("Node button clicked!")
            }
        }));
        node1.addWidget(new ToggleWidget({
            text: "Example",
        }));
        node1.addWidget(new SliderWidget({
            min: 0,
            max: 10,
            value: 7.5
        }))

        const node2 = new FlowNode({
            title: "Test Node 2 With a super long Title",
            position: { x: 300, y: 0 },
        });
        node2.addInput({ name: "test input 1", type: "string" })
        node2.addOutput({ name: "test out 1", type: "int" })

        const node3 = new FlowNode({
            title: "Node 3",
            position: { x: 850, y: 150 },
            inputs: [
                { name: "test input 1", type: "int" }
            ],
            outputs: [
                { name: "float", type: "float32" }
            ],
            widgets: [
                {
                    type: "slider",
                    config: {
                        min: 0,
                        max: 5,
                        value: 2.5,
                        snapIncrement: .25
                    }
                }
            ]
        });

        const graph = new NodeFlowGraph(canvas, {
            nodes: {
                publishers: {
                    "example": {
                        name: "Example",
                        description: "Bunch of example nodes",
                        version: "v1.0.0",
                        nodes: {
                            "widgets/slider": {
                                title: "Slider Node",
                                widgets: [
                                    {
                                        type: "slider",
                                        config: {
                                            value: 0.5,
                                        }
                                    }
                                ],
                                outputs: [
                                    {
                                        name: "out",
                                        type: "float32"
                                    }
                                ]
                            },
                            "widgets/color": {
                                title: "Color Node",
                                widgets: [
                                    {
                                        type: "color",
                                        config: {
                                        }
                                    }
                                ],
                                outputs: [
                                    {
                                        name: "out",
                                        type: "color"
                                    }
                                ]
                            }
                        }
                    },
                },
            },
            contextMenu: {
                name: "test",
                items: [
                    {
                        name: "a",
                        group: "test",
                        callback: () => { alert("a") },
                    },
                    {
                        name: "b",
                        callback: () => { alert("b") }
                    }
                ],
                subMenus: [
                    {
                        name: "sub 1",
                        group: "test",
                        items: [
                            { name: "sub a" },
                            { name: "sub b" }
                        ]
                    },
                    {
                        name: "sub 2",
                        items: [
                            { name: "sub c" },
                            { name: "sub d" }
                        ],
                        subMenus: [
                            {
                                name: "sub 3",
                                items: [
                                    { name: "sub e", callback: () => { alert("e") } },
                                    { name: "sub f" }
                                ],
                            }
                        ]
                    }
                ]
            },
            notes: [
                {
                    text: `
# Notes

This is an example of a *note* written in **markdown**.

You can place notes around your graph to help explain your graph to other users.

## Editting

*Right-click* on this note and select "Edit Note" to put your text here!

## Support

This is a minimal implementation with graph-specific functionality. Currently implemented features are:

* H1, H2, and H3
* Bold and Italic
* Unordered Lists

More will come, so feel free to open an issue for desired features! (Please search and check to make sure one hasn't already been opened up in the past)
                    `,
                    position: {
                        x: 300,
                        y: 180
                    }
                }
            ]
        });
        graph.addNode(node1);
        graph.addNode(node2);
        graph.addNode(node3);

        graph.connectNodes(node1, 0, node2, 0)
        graph.connectNodes(node2, 0, node3, 0)
    </script>
</body>

</html>